WSROOT="$(x wsroot)"
clone_xcmd_pkg()(
    x rmrf "$WSROOT/tmp"
    x mkdirp "$WSROOT/tmp"
    cd "$WSROOT/tmp" || return
    git clone git@gitee.com:x-cmd/pkg
)

f()(

    clone_xcmd_pkg || return
    x:info "Copy $WSROOT/dist to $WSROOT/tmp/pkg"

    cp -r "$WSROOT/dist" "$WSROOT/tmp/pkg/dist"

    cd "$WSROOT/tmp/pkg" || return
    git add "$WSROOT/tmp/pkg/dist/all.7z"
    git commit -m "update: dist/all.tgz"

    git push origin main
    x rmrf "$WSROOT/tmp"
)

f